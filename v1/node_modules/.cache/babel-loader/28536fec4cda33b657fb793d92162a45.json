{"ast":null,"code":"import _asyncToGenerator from\"/var/www/html/extensions/friender/extension/v1/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/var/www/html/extensions/friender/extension/v1/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/var/www/html/extensions/friender/extension/v1/node_modules/@babel/runtime/regenerator/index.js\";import React,{useState,useEffect}from\"react\";import Header from\"../Common/header\";import Footer from\"../Common/footer\";import IconLogo from\"../../../images/icon.svg\";import Box from'@mui/material/Box';import Stepper from'@mui/material/Stepper';import Step from'@mui/material/Step';import StepLabel from'@mui/material/StepLabel';import StepContent from'@mui/material/StepContent';import Button from'@mui/material/Button';import Paper from'@mui/material/Paper';import Typography from'@mui/material/Typography';import CircularProgress from'@mui/material/CircularProgress';import{profileGetter}from\"../../../helper/profileHelper\";import{GetData}from\"../../../helper/helper\";import AuthServices from\"../../../services/authService\";import FriendService from\"../../../services/friendService\";import Moment from'react-moment';import LinearProgress from'@mui/material/LinearProgress';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Setting=function Setting(){var _useState=useState({name:\"XXXXXXXX\",id:\"\",dtsg_token:\"\",image:IconLogo,username:\"XXXXXXX\",default:0,time:\"00:00:00\"}),_useState2=_slicedToArray(_useState,2),profile=_useState2[0],setProfile=_useState2[1];var _useState3=useState({totalfriend:0,totalfriendcapture:0,totalfriendcapturepersentage:0}),_useState4=_slicedToArray(_useState3,2),friendlist=_useState4[0],setFriendList=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),friendscrapingstatus=_useState6[0],setFriendScrapingStatus=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),activeStep=_useState8[0],setActiveStep=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),loader=_useState10[0],setloader=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),progress=_useState12[0],setProgress=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),circularloading=_useState14[0],setCircularloading=_useState14[1];var steps=[{label:'Connect Your Facebook Profile',description:\"The Internet has always been, and always will be, a magic box..\\n                    So Please let us connect with your profile so that we can do some more.....\",action:\"Connect Your Profile\"},{label:'Sync Your Friends List',description:\"A family is a risky venture, because the greater the love, the greater the loss\\u2026\\n         That\\u2019s the trade-off. But I\\u2019ll take it all.\\n         let Sync your Friend List\",action:\"Sync Friends\"},{label:'Create an ad',description:\"Try out different ad text to see what brings in the most customers,\\n                and learn how to enhance your ads using features like ad extensions.\\n                If you run into any problems with your ads, find out how to tell if\\n                they're running and how to resolve approval issues.\",action:\"Sync Friends Engagement\"}];var handleNext=function handleNext(){//setloader(true)\nstepActionInitiator();};var handleBack=function handleBack(){setActiveStep(function(prevActiveStep){return prevActiveStep-1;});};var handleReset=function handleReset(){setActiveStep(0);};var gfs=chrome.storage.local;//This Function will fetch User Set Profile Info\nvar fetchProfileInfo=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var user_idLocal,payloadProfile;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setloader(true);_context2.next=3;return GetData('user_id');case 3:user_idLocal=_context2.sent;if(user_idLocal){payloadProfile={user_id:user_idLocal};AuthServices.GetProfile(payloadProfile).then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(result){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log(\"This Is The User Info\",result);if(result.data.code==1){setloader(false);setProfile({name:result.data.payload.UserFacebookName,id:result.data.payload.UserFacebookid,dtsg_token:result.data.payload.UserdtsgToken,image:result.data.payload.UserFacebookImage,username:result.data.payload.UserFacebookUsername,time:result.data.payload.UserdtsgExpire});gfs.set({'UserdtsgToken':result.data.payload.UserdtsgToken});gfs.set({'UserFacebookid':result.data.payload.UserFacebookid});gfs.set({'UserFacebookUsername':result.data.payload.UserFacebookUsername});setActiveStep(function(prevActiveStep){return prevActiveStep+1;});}else{setloader(false);}case 2:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}()).catch(function(error){setloader(false);});}else{setloader(false);}case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function fetchProfileInfo(){return _ref.apply(this,arguments);};}();//This is for the initial Facebook Profile Grabing\nuseEffect(function(){fetchProfileInfo();},[]);// This Function Will Fetch User Facebook Information\nvar fetchFacebookProfileInfo=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:setCircularloading(true);_context6.next=3;return AuthServices.getProfileInfo().then(/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(ProfileResult){var ProfileInfoGetter;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return profileGetter(ProfileResult);case 2:ProfileInfoGetter=_context5.sent;if(!ProfileInfoGetter.FacebookStatus){_context5.next=8;break;}_context5.next=6;return AuthServices.getProfileAccessToken().then(/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(AccessToken){var gfs,ProfileInfo;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:console.log(\"This I got \",AccessToken);setProfile({name:ProfileInfoGetter.UserFacebookName,id:ProfileInfoGetter.UserFacebookid,dtsg_token:ProfileInfoGetter.UserdtsgToken,image:ProfileInfoGetter.UserFacebookImage,username:ProfileInfoGetter.UserFacebookUsername,time:ProfileInfoGetter.UserdtsgExpire});gfs=chrome.storage.local;gfs.set({'UserdtsgToken':ProfileInfoGetter.UserdtsgToken});gfs.set({'UserFacebookid':ProfileInfoGetter.UserFacebookid});gfs.set({'UserFacebookUsername':ProfileInfoGetter.UserFacebookUsername});gfs.set({'UserFacebookAccessToken':AccessToken});_context4.next=9;return GetData('user_id');case 9:ProfileInfoGetter.user_id=_context4.sent;_context4.next=12;return GetData('kyubi_user_token');case 12:ProfileInfoGetter.kyubi_user_token=_context4.sent;ProfileInfo={UserFacebookName:ProfileInfoGetter.UserFacebookName,UserFacebookid:ProfileInfoGetter.UserFacebookid,UserdtsgToken:ProfileInfoGetter.UserdtsgToken,UserFacebookImage:ProfileInfoGetter.UserFacebookImage,UserFacebookUsername:ProfileInfoGetter.UserFacebookUsername,UserdtsgExpire:ProfileInfoGetter.UserdtsgExpire,user_id:ProfileInfoGetter.user_id,kyubi_user_token:ProfileInfoGetter.kyubi_user_token,access_token:AccessToken};_context4.next=16;return AuthServices.GetOrStoreProfile(ProfileInfo).then(/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(result){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(result.data.code==1){setProfile({name:result.data.payload.UserFacebookName,id:result.data.payload.UserFacebookid,dtsg_token:result.data.payload.UserdtsgToken,image:result.data.payload.UserFacebookImage,username:result.data.payload.UserFacebookUsername,time:result.data.payload.UserdtsgExpire});setCircularloading(false);setActiveStep(1);}else{console.log(\"Error For Profile Info Storing1\");setCircularloading(false);}case 1:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x4){return _ref6.apply(this,arguments);};}()).catch(function(error){console.log(\"Error For Profile Info Storing2\");setCircularloading(false);});case 16:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x3){return _ref5.apply(this,arguments);};}());case 6:_context5.next=10;break;case 8://Error For Profile Info \nconsole.log(\"Error For Profile Info Scraping2\");setCircularloading(false);case 10:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x2){return _ref4.apply(this,arguments);};}()).catch(function(error){console.log(\"Error For Profile Info Storing1\");setCircularloading(false);});case 3:case\"end\":return _context6.stop();}}},_callee6);}));return function fetchFacebookProfileInfo(){return _ref3.apply(this,arguments);};}();// This Function will fetch Facebook Friends\nvar fetchFacebookFriendsListAndCounts=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee10(user_id,dtsgToken,Facebookid,Username,FacebookCursior){var TotalFriendPayload;return _regeneratorRuntime.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:setProgress(true);TotalFriendPayload={dtsg:dtsgToken,FBuserId:Facebookid,cursor:FacebookCursior};FriendService.GetFacebookFriends(TotalFriendPayload).then(/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(resultFriendList){return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:console.log(\"This are the Facebook Info\",resultFriendList);if(!resultFriendList.success){_context9.next=6;break;}_context9.next=4;return resultFriendList.friends.map(/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(friend){var access_tokenLocal,IndvFriendPayload;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:console.log(\"Please check this friend \",friend.node);_context8.next=3;return GetData('access_token');case 3:access_tokenLocal=_context8.sent;IndvFriendPayload={dtsg:dtsgToken,FBuserId:Facebookid,cursor:FacebookCursior,FriendId:friend.node.url,AccessTokenVal:access_tokenLocal};_context8.next=7;return FriendService.getFriendDetailInfo(IndvFriendPayload).then(/*#__PURE__*/function(){var _ref10=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(FriendDetails){return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:console.log(\"this are the FriendDetails\",FriendDetails);case 1:case\"end\":return _context7.stop();}}},_callee7);}));return function(_x12){return _ref10.apply(this,arguments);};}());case 7:case\"end\":return _context8.stop();}}},_callee8);}));return function(_x11){return _ref9.apply(this,arguments);};}());case 4:_context9.next=8;break;case 6:console.log(\"Error For Getting the Friend Info\");setProgress(false);case 8:case\"end\":return _context9.stop();}}},_callee9);}));return function(_x10){return _ref8.apply(this,arguments);};}()).catch(function(error){console.log(\"From Setting Page\",error);setProgress(false);});case 3:case\"end\":return _context10.stop();}}},_callee10);}));return function fetchFacebookFriendsListAndCounts(_x5,_x6,_x7,_x8,_x9){return _ref7.apply(this,arguments);};}();// This Function Depending on the step will perform the Pulling action\nvar stepActionInitiator=/*#__PURE__*/function(){var _ref11=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee11(){var user_idLocal,UserdtsgTokenLocal,UserFacebookidLocal,UserFacebookUsernameLocal,UserFacebookCursior;return _regeneratorRuntime.wrap(function _callee11$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:if(!(activeStep===0)){_context11.next=5;break;}console.log(\"Please call the function to get the user facebook Info\");fetchFacebookProfileInfo();//setActiveStep(1);\n_context11.next=24;break;case 5:if(!(activeStep===1)){_context11.next=23;break;}console.log(\"Please call the function to get the user facebook Friend Info\");_context11.next=9;return GetData('user_id');case 9:user_idLocal=_context11.sent;_context11.next=12;return GetData('UserdtsgToken');case 12:UserdtsgTokenLocal=_context11.sent;_context11.next=15;return GetData('UserFacebookid');case 15:UserFacebookidLocal=_context11.sent;_context11.next=18;return GetData('UserFacebookUsername');case 18:UserFacebookUsernameLocal=_context11.sent;UserFacebookCursior=\"\";fetchFacebookFriendsListAndCounts(user_idLocal,UserdtsgTokenLocal,UserFacebookidLocal,UserFacebookUsernameLocal,UserFacebookCursior);//setActiveStep(2);\n_context11.next=24;break;case 23:console.log(\"Please call the function to get the user facebook Friend Association Info\");//setActiveStep(3);\ncase 24:case\"end\":return _context11.stop();}}},_callee11);}));return function stepActionInitiator(){return _ref11.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"settings\",children:[loader&&/*#__PURE__*/_jsx(\"div\",{className:\"after_login_refresh\",children:/*#__PURE__*/_jsx(\"img\",{src:process.kyubi.loader.preLoader,alt:\"\"})}),/*#__PURE__*/_jsx(Header,{selectedtab:\"dashboard\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"after_log_profile\",children:[/*#__PURE__*/_jsx(\"img\",{src:profile.image,alt:\"\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Welcome\"}),/*#__PURE__*/_jsx(\"h3\",{children:profile.name}),/*#__PURE__*/_jsx(\"h5\",{children:profile.username}),/*#__PURE__*/_jsxs(\"h7\",{children:[\"Your Profile is Synced for \",/*#__PURE__*/_jsx(Moment,{date:profile.time,format:\"hh:mm:ss\",trim:true,durationFromNow:true,unix:true,interval:1000})]})]}),/*#__PURE__*/_jsxs(Box,{sx:{maxWidth:400},children:[/*#__PURE__*/_jsx(Stepper,{activeStep:activeStep,orientation:\"vertical\",children:steps.map(function(step,index){return/*#__PURE__*/_jsxs(Step,{children:[/*#__PURE__*/_jsx(StepLabel,{optional:index===2?/*#__PURE__*/_jsx(Typography,{variant:\"caption\",children:\"Last step\"}):null,children:step.label}),/*#__PURE__*/_jsx(StepContent,{children:circularloading===false?/*#__PURE__*/_jsx(\"div\",{children:progress===false?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Typography,{children:step.description}),/*#__PURE__*/_jsx(Box,{sx:{mb:2},children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:handleNext,sx:{mt:1,mr:1},children:index===steps.length-1?'Finish':step.action}),/*#__PURE__*/_jsx(Button,{disabled:index===0,onClick:handleBack,sx:{mt:1,mr:1},children:\"Back\"})]})})]}):/*#__PURE__*/_jsx(StepContent,{children:/*#__PURE__*/_jsxs(Box,{sx:{maxWidth:400},children:[/*#__PURE__*/_jsx(Box,{sx:{width:'80%'},children:/*#__PURE__*/_jsx(LinearProgress,{variant:\"determinate\",value:friendlist.totalfriendcapturepersentage})}),/*#__PURE__*/_jsx(Box,{sx:{minWidth:35},children:/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"text.secondary\",children:[\"Syncked \",friendlist.totalfriendcapture,\" out of \",friendlist.totalfriend,\" (\",friendlist.totalfriendcapturepersentage,\"%) ....\"]})})]})})}):/*#__PURE__*/_jsx(Box,{sx:{display:'flex'},children:/*#__PURE__*/_jsx(CircularProgress,{color:\"primary\"})})})]},step.label);})}),activeStep===steps.length&&/*#__PURE__*/_jsxs(Paper,{square:true,elevation:0,sx:{p:3},children:[/*#__PURE__*/_jsx(Typography,{children:\"All steps completed - you're finished\"}),/*#__PURE__*/_jsx(Button,{onClick:handleReset,sx:{mt:1,mr:1},children:\"Reset\"})]})]})]});};export default Setting;","map":null,"metadata":{},"sourceType":"module"}