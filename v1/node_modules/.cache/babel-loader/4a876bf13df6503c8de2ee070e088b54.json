{"ast":null,"code":"import _asyncToGenerator from\"/var/www/html/extensions/friender/extension/v1/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"/var/www/html/extensions/friender/extension/v1/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _classCallCheck from\"/var/www/html/extensions/friender/extension/v1/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/var/www/html/extensions/friender/extension/v1/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/var/www/html/extensions/friender/extension/v1/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/var/www/html/extensions/friender/extension/v1/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import _regeneratorRuntime from\"/var/www/html/extensions/friender/extension/v1/node_modules/@babel/runtime/regenerator/index.js\";import React,{Component}from\"react\";import{NavLink,withRouter}from'react-router-dom';import{connect}from'react-redux';import{kyubiExtensionId}from\"../../../config\";import\"./login.css\";import AuthServices from\"../../../services/authService\";import loginHelper from\"../../../helper/loginHelper\";import{OpenPoweredBy,OpenTier5Partnership,OpenFacebookLink,OpenMessengerLink,OpenSignupLink,GetData}from'../../../helper/helper';import logo from\"../../../images/logo1.svg\";import biglogo from\"../../../images/biglogo.svg\";import LoaderLogo from\"../../../images/Loader.gif\";import mail from\"../../../images/mail.svg\";import lock from\"../../../images/lock.svg\";import messanger from\"../../../images/Messanger.svg\";import path from\"../../../images/Path3.svg\";import*as authAction from'../../../store/actions/Auth/authAction';import getDeviceId from\"../../../helper/generateDeviceID\";import Footer from\"../Common/footer\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Login=/*#__PURE__*/function(_Component){_inherits(Login,_Component);var _super=_createSuper(Login);function Login(props){var _this;_classCallCheck(this,Login);_this=_super.call(this,props);_this.inputChangeHandller=function(event){_this.setState(_defineProperty({},event.target.name,event.target.value));};_this.loginHandler=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(event){var gfs,payload,_payload;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:event.preventDefault();gfs=chrome.storage.local;_this.setState({loader:true});payload={email:_this.state.email,password:_this.state.password};if(!_this.handleLoginFormValidation()){_context3.next=12;break;}_this.setState({error:false});_this.setState({errorMessage:\"\"});// let subscription = await GetData('subscription');\n_payload={extensionId:process.kyubi.extId,email:_this.state.email,password:_this.state.password,deviceId:getDeviceId(),confirmLogout:_this.state.confirmationVal// subscription: subscription ? subscription : null\n};// console.log(\"subscription : \", subscription);\n// console.log(\"payload : \", payload);\n_context3.next=10;return AuthServices.login(_payload).then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(result){var token,tokens,myObj,UserPayload;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(result.data.code===1)){_context2.next=15;break;}console.log(\"result : \",result);token=result.data.token;tokens=token.split(\".\");tokens=atob(tokens[1]);myObj=JSON.parse(tokens);console.log(\"Tis Is my Obj\",myObj);//this.props.setProfileInfo(myObj);\n// console.log(\"Tis Is my Obj11\",this.props.ProfileInfo.profileInfo)\n//this.props.setProfileInfo(myObj);\n// console.log(\"Tis Is my Obj11\",this.props.ProfileInfo.profileInfo)\ngfs.set({'kyubi_user_token':myObj.user.id});gfs.set({'kyubi_email':myObj.user.email});UserPayload={kyubi_user_token:myObj.user.id,user_email:myObj.user.email,plan:result.data.plan,status:result.data.status};_context2.next=12;return AuthServices.GetOrStoreUser(UserPayload).then(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(result){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log(result);_this.setState({loader:false});gfs.set({'user_id':result.data.payload._id});gfs.set({'kyubi_plan':result.data.payload.plan});gfs.set({'kyubi_profile_count':result.data.payload.profile_count});gfs.set({'kyubi_profile_status':result.data.payload.status});_this.props.history.push('/dashboard');case 7:case\"end\":return _context.stop();}}},_callee);}));return function(_x3){return _ref3.apply(this,arguments);};}()).catch(function(error){// console.log(error);\n_this.setState({loader:false});_this.setState({errorMessage:\"User not found or In-Active\"});_this.setState({error:true});});case 12:console.log(\"Let Me Get The Data\",UserPayload);//this.props.history.push('/dashboard');\n_context2.next=18;break;case 15:_this.setState({loader:false});_this.setState({errorMessage:\"User not found or In-Active\"});_this.setState({error:true});case 18:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}()).catch(function(error){// console.log(error);\n_this.setState({loader:false});_this.setState({errorMessage:\"User not found or In-Active\"});_this.setState({error:true});});case 10:_context3.next=13;break;case 12:_this.setState({error:true,loader:false});case 13:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x){return _ref.apply(this,arguments);};}();_this.callFrameHandler=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(event){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:loginHelper.framecaller();case 1:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x4){return _ref4.apply(this,arguments);};}();_this.state={email:\"\",password:\"\",loader:false,error:false,errorMessage:\"\",loadingstatus:false,confirmationVal:false};return _this;}/**\n    * @inputChangeHandller \n    * getting input field values\n    */_createClass(Login,[{key:\"checkBackgroundFetching\",value:/**\n    * @checkBackgroundFetching \n    * Check  Wether Background Fetching is  done or not\n    */function checkBackgroundFetching(){// setInterval(() => {\n//     let inBackgroundFetching=localStorage.getItem('inBackgroundFetching');\n//     // console.log(\"This check ++++++++++\",inBackgroundFetching);\n//     if(inBackgroundFetching !== \"true\"){\n//         // console.log(\"This check 111++++++++++\",inBackgroundFetching);\n//         this.props.history.push('/dashboard');       \n//     }\n// },2000);\n}/**\n    * @handleLoginFormValidation \n    * email and password field blank validation\n    */},{key:\"handleLoginFormValidation\",value:function handleLoginFormValidation(){var fields={email:this.state.email,password:this.state.password};var formIsValid=true;var emailRegex=/^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;var checkResult=emailRegex.test(String(this.state.email).toLowerCase());if(!fields[\"email\"]){formIsValid=false;this.setState({errorMessage:\"Email Is Required\"});return formIsValid;}else if(checkResult===false){formIsValid=false;this.setState({errorMessage:\"Please enter a proper email\"});return formIsValid;}else if(!fields[\"password\"]){formIsValid=false;this.setState({errorMessage:\"Password Is Required\"});return formIsValid;}else{formIsValid=true;return formIsValid;}return formIsValid;}/**\n    * @loginHandler \n    * in this function we are checking the email id, password\n    * and if the details are correct then login them and also take care about the remember password one\n    */},{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var kyubi_user_token;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:this.setState({loader:true});_context5.next=3;return GetData('kyubi_user_token');case 3:kyubi_user_token=_context5.sent;if(kyubi_user_token){this.props.history.push('/dashboard');}else{this.setState({loader:false});}case 5:case\"end\":return _context5.stop();}}},_callee5,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/_jsxs(\"div\",{children:[this.state.loader&&/*#__PURE__*/_jsx(\"div\",{class:\"after_login_refresh\",children:/*#__PURE__*/_jsx(\"img\",{src:process.kyubi.loader.preLoader,alt:\"\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"loginscreen\",style:{backgroundImage:process.kyubi.logo.background_image?\"url(\".concat(process.kyubi.logo.background_image,\")\"):''},children:[!process.kyubi.logo.background_image&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"graphics1\"}),/*#__PURE__*/_jsx(\"div\",{className:\"graphics2\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"logo\",children:/*#__PURE__*/_jsx(\"img\",{src:process.kyubi.logo.secondary_logo})}),/*#__PURE__*/_jsxs(\"div\",{className:\"login_container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"login_welcome_block\",children:[\"Welcome,\",/*#__PURE__*/_jsx(\"h3\",{children:\"Login to continue!\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"login_block\",children:/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(\"img\",{src:mail})}),/*#__PURE__*/_jsx(\"input\",{name:\"email\",id:\"email\",type:\"email\",placeholder:\"Email Address\",onChange:this.inputChangeHandller})]}),/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(\"img\",{src:lock})}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",placeholder:\"**********\",name:\"password\",id:\"password\",onChange:this.inputChangeHandller})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-right gap1\",children:/*#__PURE__*/_jsx(NavLink,{className:\"link\",to:\"/forgetPassword\",children:\"Forgot Password?\"})}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"blue_btn\",onClick:this.loginHandler,children:\"LOGIN\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"login_signup\",children:[\"Don\\u2019t have an account? \",/*#__PURE__*/_jsx(\"a\",{onClick:function onClick(event){return _this2.LinkHandler(\"optOne\",event);},href:\"#\",children:\"Sign up\"})]}),this.state.error&&/*#__PURE__*/_jsxs(\"div\",{className:\"error\",children:[\" \",this.state.errorMessage,\" *\"]})]})}),/*#__PURE__*/_jsx(Footer,{})]})]})]});}}]);return Login;}(Component);/**\n * @mapStateToProps\n * grab the values from redux store\n */var mapStateToProps=function mapStateToProps(state){return{ProfileInfo:state.auth.payload};};/**\n* @mapDispatchToProps \n* sending the values to redux store\n*/var mapDispatchToProps=function mapDispatchToProps(dispatch){return{setProfileInfo:function setProfileInfo(load){return dispatch(authAction.addProfileInfo(load));}};};export default connect(mapStateToProps,mapDispatchToProps)(withRouter(Login));","map":null,"metadata":{},"sourceType":"module"}