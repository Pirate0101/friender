{"ast":null,"code":"import _asyncToGenerator from\"/var/www/html/extensions/friender/extension/v1/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/var/www/html/extensions/friender/extension/v1/node_modules/@babel/runtime/regenerator/index.js\";import axios from'axios';import{host,kyubi}from'../config';import{serializeFBTotalReq,serializeFBFriendReq,serializeFBFriendInd}from'../helper/helper';var friendervice={scrapFriends:function scrapFriends(payload){return new Promise(function(resolve,reject){fetch(\"https://www.facebook.com/api/graphql/\",{method:\"POST\",headers:{\"Content-Type\":\"application/x-www-form-urlencoded\",Accept:\"text/html,application/json\",\"x-fb-friendly-name\":\"FriendingCometFriendsListPaginationQuery\"},body:payload}).then(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(result){var resp,dataToSync;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log(\"-------\",result);_context.next=3;return result.json();case 3:resp=_context.sent;if(resp.hasOwnProperty(\"data\")){if(resp.data.hasOwnProperty(\"viewer\")){if(resp.data.viewer.hasOwnProperty(\"all_friends\")){if(resp.data.viewer.all_friends.hasOwnProperty(\"edges\")){dataToSync=[];console.log(resp.data.viewer.all_friends.edges.length);}console.log(resp.data.viewer.all_friends);}}}case 5:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());});// return new Promise((resolve, reject) => {\n//     let options = {\n//         method: 'POST',\n//         url: \"https://www.facebook.com/api/graphql/\",\n//         headers: {  \n//             \"baseURL\": \"https://www.facebook.com\",\n//             \"Content-Type\": \"application/x-www-form-urlencoded\",\n//             \"Accept\": \"text/html,application/json\",\n//             \"x-fb-friendly-name\": \"FriendingCometFriendsListPaginationQuery\",\n//     },\n//     body: payload\n//     }\n//     axios(options)\n//         .then(res => {\n//             console.log(\"In Success\");\n//             resolve(res)\n//         })\n//         .catch(err => {\n//             // console.log(\"In Error\");\n//             reject(err)\n//         })\n// })\n},GetTotalFacebookFriends:function(){var _GetTotalFacebookFriends=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(payload){var serilizedData;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return serializeFBTotalReq(payload.FBuserId,payload.dtsg,payload.cursor);case 2:serilizedData=_context3.sent;return _context3.abrupt(\"return\",new Promise(function(resolve,reject){fetch(\"https://www.facebook.com/api/graphql/\",{method:\"POST\",headers:{\"Content-Type\":\"application/x-www-form-urlencoded\",Accept:\"text/html,application/json\",\"x-fb-friendly-name\":\"FriendingCometFriendsListPaginationQuery\"},body:serilizedData}).then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(result){var resp;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return result.json();case 2:resp=_context2.sent;if(resp.hasOwnProperty(\"data\")){if(resp.data.hasOwnProperty(\"viewer\")){console.log(\"==========2==================\",resp.data.viewer);if(resp.data.viewer.hasOwnProperty(\"all_friends_data\")){console.log(\"============================\",resp.data.viewer.all_friends_data.count);resolve({'success':true,'count':resp.data.viewer.all_friends_data.count});}else{reject({'success':false,'count':0});}}else{reject({'success':false,'count':0});}}else{reject({'success':false,'count':0});}case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x3){return _ref2.apply(this,arguments);};}()).catch(function(error){console.log(\"Friend Counts Error\",error);reject({'success':false,'count':0});});}));case 4:case\"end\":return _context3.stop();}}},_callee3);}));function GetTotalFacebookFriends(_x2){return _GetTotalFacebookFriends.apply(this,arguments);}return GetTotalFacebookFriends;}(),StoreTotalFacebookFriends:function StoreTotalFacebookFriends(payload){return new Promise(function(resolve,reject){console.log(\"This is the payload\",payload);var options={method:'POST',url:host+'/api/friendcounter/saveOrUpdate',headers:{'Accept':'application/json','Content-Type':'application/json'},data:payload};axios(options).then(function(res){// console.log(\"In Success\");\nresolve(res);}).catch(function(err){// console.log(\"In Error\");\nreject(err);});});},ScrapFacebookFriends:function(){var _ScrapFacebookFriends=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(payload){var serilizedDataNew;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return serializeFBFriendReq(payload.FBuserId,payload.dtsg,payload.cursor);case 2:serilizedDataNew=_context5.sent;console.log(serilizedDataNew);return _context5.abrupt(\"return\",new Promise(function(resolve,reject){setTimeout(function(){fetch(\"https://www.facebook.com/api/graphql/\",{method:\"POST\",headers:{\"Content-Type\":\"application/x-www-form-urlencoded\",Accept:\"text/html,application/json\",\"x-fb-friendly-name\":\"FriendingCometFriendsListPaginationQuery\"},body:serilizedDataNew}).then(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(result){var resp;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return result.json();case 2:resp=_context4.sent;if(resp.hasOwnProperty(\"data\")){console.log(\"==========3==================\",resp.data);if(resp.data.hasOwnProperty(\"viewer\")){console.log(\"==========4==================\",resp.data.viewer);if(resp.data.viewer.hasOwnProperty(\"all_friends_data\")){console.log(\"===========5=================\",resp.data.viewer.all_friends_data);resolve({'success':true,'count':resp.data.viewer.all_friends_data});}else{reject({'success':false,'count':0});}}else{reject({'success':false,'count':0});}}else{reject({'success':false,'count':0});}case 4:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x5){return _ref3.apply(this,arguments);};}()).catch(function(error){console.log(\"Friend Counts Error\",error);reject({'success':false,'count':0});});},5000);}));case 5:case\"end\":return _context5.stop();}}},_callee5);}));function ScrapFacebookFriends(_x4){return _ScrapFacebookFriends.apply(this,arguments);}return ScrapFacebookFriends;}(),GetFacebookFriends:function(){var _GetFacebookFriends=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(payload){var serilizedData;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return serializeFBFriendReq(payload.FBuserId,payload.dtsg,payload.cursor);case 2:serilizedData=_context7.sent;return _context7.abrupt(\"return\",new Promise(function(resolve,reject){fetch(\"https://www.facebook.com/api/graphql/\",{method:\"POST\",headers:{\"Content-Type\":\"application/x-www-form-urlencoded\",Accept:\"text/html,application/json\",\"x-fb-friendly-name\":\"FriendingCometFriendsListPaginationQuery\"},body:serilizedData}).then(/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(result){var resp;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return result.json();case 2:resp=_context6.sent;if(resp.hasOwnProperty(\"data\")){console.log(\"==========3==================\",resp.data);if(resp.data.hasOwnProperty(\"viewer\")){console.log(\"==========4==================\",resp.data.viewer);if(resp.data.viewer.hasOwnProperty(\"all_friends_data\")){console.log(\"===========5=================\",resp.data.viewer.all_friends_data);if(resp.data.viewer.hasOwnProperty(\"all_friends\")){if(resp.data.viewer.all_friends.hasOwnProperty(\"edges\")){if(resp.data.viewer.all_friends.hasOwnProperty(\"page_info\")){resolve({'success':true,'count':resp.data.viewer.all_friends_data.count,'friends':resp.data.viewer.all_friends.edges,'end_cursor':resp.data.viewer.all_friends.page_info.end_cursor,'has_next_page':resp.data.viewer.all_friends.page_info.has_next_page});}else{resolve({'success':true,'count':resp.data.viewer.all_friends_data,'friends':resp.data.viewer.all_friends.edges,'end_cursor':\"\",'has_next_page':false});reject({'success':false,'count':0});}}else{reject({'success':false,'count':0});}}else{reject({'success':false,'count':0});}}else{reject({'success':false,'count':0});}}else{reject({'success':false,'count':0});}}else{reject({'success':false,'count':0});}case 4:case\"end\":return _context6.stop();}}},_callee6);}));return function(_x7){return _ref4.apply(this,arguments);};}()).catch(function(error){console.log(\"Friend Counts Error\",error);reject({'success':false,'count':0});});}));case 4:case\"end\":return _context7.stop();}}},_callee7);}));function GetFacebookFriends(_x6){return _GetFacebookFriends.apply(this,arguments);}return GetFacebookFriends;}(),getFriendDetailInfo:function(){var _getFriendDetailInfo=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(payload){var serilizedData;return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_context9.next=2;return serializeFBFriendInd(payload.FBuserId,payload.dtsg,payload.cursor,payload.FriendId);case 2:serilizedData=_context9.sent;return _context9.abrupt(\"return\",new Promise(function(resolve,reject){fetch(\"https://www.facebook.com/api/graphql/\",{method:\"POST\",headers:{\"Content-Type\":\"application/x-www-form-urlencoded\",Accept:\"text/html,application/json\",\"x-fb-friendly-name\":\"ProfileCometTimelineFeedRefetchQuery\"},body:serilizedData}).then(/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(result){var resp;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.next=2;return result.json();case 2:resp=_context8.sent;if(resp.hasOwnProperty(\"data\")){console.log(\"==========3==================\",resp.data);}else{reject({'success':false,'count':0});}case 4:case\"end\":return _context8.stop();}}},_callee8);}));return function(_x9){return _ref5.apply(this,arguments);};}()).catch(function(error){console.log(\"Friend Counts Error\",error);reject({'success':false,'count':0});});}));case 4:case\"end\":return _context9.stop();}}},_callee9);}));function getFriendDetailInfo(_x8){return _getFriendDetailInfo.apply(this,arguments);}return getFriendDetailInfo;}()};export default friendervice;","map":null,"metadata":{},"sourceType":"module"}