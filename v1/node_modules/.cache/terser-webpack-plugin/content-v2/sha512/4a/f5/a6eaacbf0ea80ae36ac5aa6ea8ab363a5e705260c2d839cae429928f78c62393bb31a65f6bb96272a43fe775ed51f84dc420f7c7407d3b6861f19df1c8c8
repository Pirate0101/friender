{"code":"!function(e){var o={};function t(n){if(o[n])return o[n].exports;var s=o[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,t),s.l=!0,s.exports}t.m=e,t.c=o,t.d=function(e,o,n){t.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:n})},t.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},t.t=function(e,o){if(1&o&&(e=t(e)),8&o)return e;if(4&o&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&o&&\"string\"!=typeof e)for(var s in e)t.d(n,s,function(o){return e[o]}.bind(null,s));return n},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,\"a\",o),o},t.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},t.p=\"\",t(t.s=39)}({13:function(e){e.exports=JSON.parse('{\"fbAPIHostname\":\"https://www.facebook.com\",\"mfbAPIHostname\":\"https://m.facebook.com\",\"businessfbAPIHostname\":\"https://business.facebook.com\",\"mBasicUrl\":\"https://mbasic.facebook.com\"}')},34:function(e,o,t){const{fbGrabRouteData:n}=t(4),s=(e,o,t)=>{try{let n={av:e,__user:e,__a:1,dpr:1,fb_dtsg:o,fb_api_caller_class:\"RelayModern\",fb_api_req_friendly_name:\"FriendingCometFriendsListPaginationQuery\",variables:JSON.stringify({count:30,cursor:t,name:null,scale:1}),server_timestamps:!0,doc_id:5393753507311167},s=[];for(let e in n)n.hasOwnProperty(e)&&s.push(encodeURIComponent(e)+\"=\"+encodeURIComponent(n[e]));return s.join(\"&\")}catch(e){}};e.exports={ScrapFacebookFriends:async function(e){let o=await s(e.FBuserId,e.dtsg,e.cursor);return new Promise((t,n)=>{setTimeout(()=>{fetch(\"https://www.facebook.com/api/graphql/\",{method:\"POST\",headers:{\"Content-Type\":\"application/x-www-form-urlencoded\",Accept:\"text/html,application/json\",\"x-fb-friendly-name\":\"FriendingCometFriendsListPaginationQuery\"},body:o}).then(async o=>{let s=await o.json();s.hasOwnProperty(\"data\")?(console.log(\"==========3==================\",s.data),s.data.hasOwnProperty(\"viewer\")?(console.log(\"==========4==================\",s.data.viewer),s.data.viewer.hasOwnProperty(\"all_friends\")?(console.log(\"===========5=================\",s.data.viewer.all_friends),s.data.viewer.hasOwnProperty(\"all_friends\")?s.data.viewer.all_friends.hasOwnProperty(\"edges\")?s.data.viewer.all_friends.hasOwnProperty(\"page_info\")?t({success:!0,count:0,kyubi_user_token:e.kyubi_user_token,User_id:e.User_id,friends:s.data.viewer.all_friends.edges,end_cursor:s.data.viewer.all_friends.page_info.end_cursor,has_next_page:s.data.viewer.all_friends.page_info.has_next_page}):(t({success:!0,count:0,kyubi_user_token:e.kyubi_user_token,User_id:e.User_id,friends:s.data.viewer.all_friends.edges,end_cursor:\"\",has_next_page:!1}),n({success:!1,count:1})):n({success:!1,count:2}):n({success:!1,count:3})):n({success:!1,count:4})):n({success:!1,count:5})):n({success:!1,count:6})}).catch(e=>{console.log(\"Friend Counts Error\",e),n({success:!1,count:7})})},5e3)})},fetchCollectionToken:async(e,o,t)=>{const s=\"\"===t||Number.isInteger(parseInt(t))?`profile.php?id=${o}&sk=friends_all`:`/${t}/friends_all`;return new Promise(async(t,r)=>{try{const r=(await n(e,s,o)).text.match(/\"collectionToken\":\"(.*?)\"/);if(r&&Array.isArray(r)){t(r[1])}}catch(e){r(e)}})},ScrapSlowFacebookFriends:async function(e){console.log(\"ScrapSlowFacebookFriends\",e);const o=((e,o,t,n)=>{try{let s={av:e,__user:e,__a:1,dpr:1,fb_dtsg:o,fb_api_caller_class:\"RelayModern\",fb_api_req_friendly_name:\"ProfileCometAppCollectionListRendererPaginationQuery\",variables:JSON.stringify({count:20,cursor:t,search:null,scale:1,id:n}),server_timestamps:!0,doc_id:0xd8dac09faf5cd},r=[];for(let e in s)s.hasOwnProperty(e)&&r.push(encodeURIComponent(e)+\"=\"+encodeURIComponent(s[e]));return r.join(\"&\")}catch(e){}})(e.FBuserId,e.dtsg,e.cursor,e.collectionToken);return new Promise((t,n)=>{setTimeout(()=>{fetch(\"https://www.facebook.com/api/graphql/\",{method:\"POST\",headers:{Accept:\"*/*\",\"content-type\":\"application/x-www-form-urlencoded\"},body:o}).then(async o=>{let s=await o.json();s.hasOwnProperty(\"data\")?(console.log(\"==========33==================\",s.data),s.data.hasOwnProperty(\"node\")?(console.log(\"==========44==================\",s.data.node),s.data.node.hasOwnProperty(\"pageItems\")?(console.log(\"===========55=================\",s.data.node.pageItems),s.data.node.pageItems.hasOwnProperty(\"edges\")?(console.log(\"===========66=================\",s.data.node.pageItems.edges),s.data.node.pageItems.hasOwnProperty(\"page_info\")?t({success:!0,count:0,kyubi_user_token:e.kyubi_user_token,User_id:e.User_id,friends:s.data.node.pageItems.edges,end_cursor:s.data.node.pageItems.page_info.end_cursor,has_next_page:s.data.node.pageItems.page_info.has_next_page}):(t({success:!0,count:0,kyubi_user_token:e.kyubi_user_token,User_id:e.User_id,friends:s.data.node.pageItems.edges,end_cursor:\"\",has_next_page:!1}),n({success:!1,count:1}))):n({success:!1,count:3})):n({success:!1,count:4})):n({success:!1,count:5})):n({success:!1,count:6})}).catch(e=>{console.log(\"Friend Counts Error\",e),n({success:!1,count:7})})},5e3)})},ScrapNewSlowFacebookFriends:async function(e){let o=await s(e.FBuserId,e.dtsg,e.cursor,e.collectionToken);return console.log(o),new Promise((t,n)=>{setTimeout(()=>{fetch(\"https://www.facebook.com/api/graphql/\",{method:\"POST\",headers:{\"Content-Type\":\"application/x-www-form-urlencoded\",Accept:\"text/html,application/json\",\"x-fb-friendly-name\":\"FriendingCometFriendsListPaginationQuery\"},body:o}).then(async o=>{let s=await o.json();s.hasOwnProperty(\"data\")?(console.log(\"==========3==================\",s.data),s.data.hasOwnProperty(\"viewer\")?(console.log(\"==========4==================\",s.data.viewer),s.data.viewer.hasOwnProperty(\"all_friends\")?(console.log(\"===========5=================\",s.data.viewer.all_friends),s.data.viewer.hasOwnProperty(\"all_friends\")?s.data.viewer.all_friends.hasOwnProperty(\"edges\")?s.data.viewer.all_friends.hasOwnProperty(\"page_info\")?t({success:!0,count:0,kyubi_user_token:e.kyubi_user_token,User_id:e.User_id,friends:s.data.viewer.all_friends.edges,end_cursor:s.data.viewer.all_friends.page_info.end_cursor,has_next_page:s.data.viewer.all_friends.page_info.has_next_page}):(t({success:!0,count:0,kyubi_user_token:e.kyubi_user_token,User_id:e.User_id,friends:s.data.viewer.all_friends.edges,end_cursor:\"\",has_next_page:!1}),n({success:!1,count:1})):n({success:!1,count:2}):n({success:!1,count:3})):n({success:!1,count:4})):n({success:!1,count:5})):n({success:!1,count:6})}).catch(e=>{console.log(\"Friend Counts Error\",e),n({success:!1,count:7})})},2e3)})},fetchFacebookFriendDetails:async function(e){await serializeFBFDetails(e.FriendFacebookid,e.ProfileURL,e.UserFacebookId,e.UserdtsgToken)},getAboutFriend:e=>{console.log(\"This is x\",e);let o=\"\";o=-1!=e.ProfileURL.indexOf(\"?id=\")?e.ProfileURL+\"&sk=about_overview\":e.ProfileURL+\"/about_overview\"}}},39:function(e,o,t){\"use strict\";t.r(o);var n=t(34),s=t(4);var r=e=>JSON.stringify(e);const a=\"post\";chrome.storage.local.set({tabInfo:{isBlocked:!1,tabId:0},isFirstTime:!0});const i=(e,o,t)=>fetch(\"http://localhost:8081\"+e,{method:o,headers:{Accept:\"application/json\",\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":!0},body:t});chrome.runtime.onMessageExternal.addListener((async function(e,o,t){if(console.log(\"This is the Sender\",o),console.log(\"This is the request\",e),console.log(\"This is the sendResponse\",t),\"GetUserFaceBookAuth\"===e.type&&Object(s.fbDtsg)(null,async o=>{if(o.parameters.LoggedInFacebook){console.log(\"GetUserFaceBookAuth: Logged in User Data\",o.parameters),console.log(\"GetUserFaceBookAuth: DTSG\",o.dtsg);let t=await Object(n.fetchCollectionToken)(o.parameters.dtsg.token,o.parameters.FacebookId,o.parameters.FacebookUsername);console.log(\"GetUserFaceBookAuth: Collection Token\",t);let s={user_id:e.options._id,kyubi_user_token:e.options.kyubi_user_token,UserFacebookName:o.parameters.FacebookName,UserFacebookid:o.parameters.FacebookId,UserdtsgToken:o.parameters.dtsg.token,UserFacebookImage:o.parameters.FacebookImage,UserFacebookUsername:o.parameters.FacebookUsername,UserdtsgExpire:o.parameters.dtsg.expire,access_token:o.dtsg.token,UsercollectionToken:t};await i(\"/api/user/CheckThenStoreProfileInfo\",a,r(s)).then(async e=>{console.log(\"GetUserFaceBookAuth: Response from server\",e),await e.json()}).catch(e=>{})}else{let o={user_id:e.options._id,kyubi_user_token:e.options.kyubi_user_token,UserFacebookName:!1,UserFacebookid:!1,UserdtsgToken:!1,UserFacebookImage:!1,UserFacebookUsername:!1,UserdtsgExpire:!1,access_token:!1};await i(\"/api/user/CheckThenStoreProfileInfo\",a,r(o)).then(async e=>{console.log(\"GetUserFaceBookAuth: Response from server in else part\",e),await e.json()}).catch(e=>{})}}),\"GetFacebookFriends\"===e.type){let o={dtsg:e.options.UserdtsgToken,FBuserId:e.options.UserFacebookid,kyubi_user_token:e.options.kyubi_user_token,User_id:e.options._id,cursor:e.options.end_cursor,collectionToken:e.options.UsercollectionToken,profileId:e.options.UserProfileId};await async function e(o,t=!0){await Object(n.ScrapFacebookFriends)(o).then(async n=>{if(console.log(\"GetFacebookFriends::CallBaseFacebookAPIToGetFriend ===>\",n),!0===n.success){let s=[],c={};if(await n.friends.map(async e=>{s.push({friend:e.node}),c={dtsg:o.dtsg,FBuserId:o.FBuserId,kyubi_user_token:o.kyubi_user_token,User_id:o.User_id,cursor:e.cursor,collectionToken:o.collectionToken,profileId:o.profileId}}),!0===n.has_next_page){let d={totalFriends:0,friends:s,kyubi_user_token:o.kyubi_user_token,User_id:o.User_id,has_next_page:n.has_next_page,FBuserId:o.FBuserId,profileId:o.profileId};t&&await i(\"/api/friend/StoreUserFriends\",a,r(d)).then(async e=>{console.log(\"GetFacebookFriends::CallBaseFacebookAPIToGetFriend: Response from server\",e),await e.json()}).catch(e=>{console.log(\"GetFacebookFriends::CallBaseFacebookAPIToGetFriend: found error in fetching the Profile Info\",e)}),await e(c,t)}else{let d={totalFriends:0,friends:s,kyubi_user_token:o.kyubi_user_token,User_id:o.User_id,has_next_page:n.has_next_page,FBuserId:o.FBuserId,profileId:o.profileId};t?await i(\"/api/friend/StoreUserFriends\",a,r(d)).then(async e=>{console.log(\"GetFacebookFriends::CallBaseFacebookAPIToGetFriend: Response from server to save data after last data from facebook\",e),await e.json();let t={dtsg:o.dtsg,FBuserId:o.FBuserId,kyubi_user_token:o.kyubi_user_token,User_id:o.User_id,cursor:null,collectionToken:o.collectionToken,profileId:o.profileId};console.log(\"SlowNewpayload\",t),await async function e(o){await ScrapSlowFacebookFriends(o).then(async t=>{if(console.log(\"This Is what I got from Facebook =============\",t),!0===t.success){let n=[],s={};if(await t.friends.map(async e=>{n.push({friend:e.node}),s={dtsg:o.dtsg,FBuserId:o.FBuserId,kyubi_user_token:o.kyubi_user_token,User_id:o.User_id,cursor:e.cursor,collectionToken:o.collectionToken,profileId:o.profileId}}),!0===t.has_next_page){let c={totalFriends:0,friends:n,kyubi_user_token:o.kyubi_user_token,User_id:o.User_id,has_next_page:t.has_next_page,FBuserId:o.FBuserId,profileId:o.profileId};await i(\"/api/friend/StoreUserFriends\",a,r(c)).then(async e=>{console.log(\"This is the Data I have To Send Back\",e);await e.json()}).catch(e=>{console.log(\"We are really Sorry we found error in fetching the Profile Info\",e)}),await e(s)}else{let e={totalFriends:0,friends:n,kyubi_user_token:o.kyubi_user_token,User_id:o.User_id,has_next_page:t.has_next_page,FBuserId:o.FBuserId};await i(\"/api/friend/StoreUserFriends\",a,r(e)).then(async e=>{console.log(\"This is the Data I have To Send Back\",e);await e.json(),o.dtsg,o.FBuserId,o.kyubi_user_token,o.User_id,o.collectionToken,o.profileId}).catch(e=>{console.log(\"We are really Sorry we found error in fetching the Profile Info\",e)}),console.log(\"This are the friends Request i have\",n)}}})}(t)}).catch(e=>{console.log(\"We are really Sorry we found error in fetching the Profile Info\",e)}):(c.cursor=null,await e(c)),console.log(\"This are the friends Request i have\",s)}}})}(o,!1)}\"GetFriendsFaceBookDetails\"===e.type&&(console.log(e.options),await e.options.map(async(e,o)=>{20===o&&(console.log(\"This is the Friend Info\",e),await getAboutFriend(e))})),\"GetIncomingRequestDetails\"===e.type&&c(),\"GetSentRequestDetails\"===e.type&&d()}));const c=()=>{Object(s.fbDtsg)(null,e=>{console.log(\"here\",e),e.dtsg&&e.dtsg.token&&Object(s.incomingFrndRequest)(null,e.dtsg.token,e=>{console.log(e)})})},d=()=>{Object(s.fbDtsg)(null,e=>{e.dtsg&&e.dtsg.token&&Object(s.sentFrndRequest)(null,e.dtsg.token,e=>{console.log(e)})})};c()},4:function(e,o,t){\"use strict\";t.r(o),t.d(o,\"fbDtsg\",(function(){return a})),t.d(o,\"fbAccessToken\",(function(){return i})),t.d(o,\"fbGrabRouteData\",(function(){return c})),t.d(o,\"fbGrabRouteMultiData\",(function(){return d})),t.d(o,\"aboutUs\",(function(){return l})),t.d(o,\"sentFrndRequest\",(function(){return u})),t.d(o,\"incomingFrndRequest\",(function(){return p}));var n=(e,o=!1)=>{let t=e.replace(/for\\s*\\(\\s*;\\s*;\\s*\\)\\s*;\\s*/,\"\");o&&(t=t.replace(/for \\(;;\\);/g,\"\"));let n=o?t.split(/\\r\\n/g):t.split(/\\}\\r\\n *\\{/);return 1===n.length||o?n:\"[\"+n.join(\"},{\")+\"]\"},s=t(13);const r={routeDefinition:s.fbAPIHostname+\"/ajax/route-definition/\",bulkRouteDefinition:s.fbAPIHostname+\"/ajax/bulk-route-definitions/\",businessPage:s.businessfbAPIHostname+\"/creatorstudio/home\",loggedUserData:s.mfbAPIHostname+\"/composer/ocelot/async_loader/?publisher=feed\"},a=(e,o=null,t=null)=>{fetch(r.loggedUserData,{method:\"GET\"}).then(e=>e.text()).then(t=>{let n,s,r=\"\",a=\"\",i=\"\",c=\"\",d=!1;const l=/\\\\\"suggestions\\\\\":\\[\\{[^}]*\\}/gm,u=/\\\\\"dtsg\\\\\":\\{[^}]*\\}/gm;null!=t.match(u)&&(s=t.match(u)[0],s=\"{\"+s.replace(/[\\\\]/g,\"\")+\"}\",s=JSON.parse(s).dtsg);let p={};if(l.test(t)){n=t.match(l)[0],n=\"{\"+n.replace(/[\\\\]/g,\"\")+\"]}\",n=JSON.parse(n).suggestions[0],console.log(\"sugest in login helper\",n);let e=n.path.includes(\"profile.php\")?n.uid:n.path.replace(\"/\",\"\");i=n.uid,r=e,a=n.text,c=n.photo,d=!0,p={FacebookId:i,FacebookUsername:r,FacebookName:a,FacebookImage:c,LoggedInFacebook:d,dtsg:s}}else d=!1,p={FacebookId:i,FacebookUsername:r,FacebookName:a,FacebookImage:c,LoggedInFacebook:d,dtsg:s};if(\"function\"!=typeof o)return console.log(\"Here in dtsg function before callback else\"),{data:e,dtsg:s,sugest:n,parameters:p};console.log(\"Here in dtsg function before callback\"),o({data:e,dtsg:s,sugest:n,parameters:p})}).catch(n=>{console.log(\"Here in dtsg function error\",n),o&&o(e,null,t)})},i=(e=null)=>{fetch(r.businessPage,{method:\"GET\",mode:\"cors\",headers:{authority:\"business.facebook.com\",\"Content-Type\":\"application/x-www-form-urlencoded\",Accept:\"text/html,application/json\"}}).then(e=>e.text()).then(o=>{const t=o.match(/\"userAccessToken\":\"(.*?)\"/);if(t&&Array.isArray(t)){let o=t[1];e(o,t)}}).catch(()=>{e&&e(null)})},c=async(e,o,t,s=null)=>{var a=new FormData;return a.append(\"fb_dtsg\",e),a.append(\"route_url\",o),a.append(\"client_previous_actor_id\",t),a.append(\"__user\",t),a.append(\"routing_namespace\",\"fb_comet\"),a.append(\"__comet_req\",1),a.append(\"__a\",1),a.append(\"dpr\",1),await fetch(r.routeDefinition,{body:a,headers:{accept:\"application/json, text/plain, */*\"},method:\"POST\"}).then(e=>e.text()).then(e=>{let o=n(e,!0);if(\"function\"!=typeof s)return{text:o.length?o[0]:\"\",parseAble:n(e),loggedUserId:t};s({text:o.length?o[0]:\"\",parseAble:o},t)})},d=async(e,o,t,s=null)=>{var a=new FormData;a.append(\"fb_dtsg\",e),o.forEach((e,o)=>{a.append(`route_urls[${o}]`,e)}),a.append(\"client_previous_actor_id\",t),a.append(\"__user\",t),a.append(\"routing_namespace\",\"fb_comet\"),a.append(\"__comet_req\",1),a.append(\"__a\",1),a.append(\"dpr\",1),fetch(r.routeDefinition,{body:a,headers:{accept:\"application/json, text/plain, */*\"},method:\"POST\"}).then(e=>e.text()).then(e=>{let o=n(e,!0);if(\"function\"!=typeof s)return{text:o.length?o[0]:\"\",parseAble:n(e),userId:userId};s({text:o.length?o[0]:\"\",parseAble:o},userId)})},l=(e,o=null)=>{a(null,o=>{d(o.dtsg,e,o.parameters.FacebookId,e=>{})})},u=async(e=null,o,t=null)=>{let n=e?{scale:1}:{scale:2,cursor:e,count:20},s={__a:\"1\",fb_dtsg:o,fb_api_caller_class:\"RelayModern\",fb_api_req_friendly_name:\"FriendingCometOutgoingRequestsDialogQuery\",variables:JSON.stringify(n),doc_id:\"4197414966995373\",server_timestamps:!0},r=await fetch(\"https://www.facebook.com/api/graphql/\",{method:\"POST\",headers:{\"Content-Type\":\"application/x-www-form-urlencoded\",Accept:\"text/html,application/json\",\"x-fb-friendly-name\":\"FriendingCometOutgoingRequestsDialogQuery\"},body:function(e){let o=[];for(let t in e)e.hasOwnProperty(t)&&o.push(encodeURIComponent(t)+\"=\"+encodeURIComponent(e[t]));return o.join(\"&\")}(s)}),a=await r.json(),i=0,c=[];if(a.data&&a.data.viewer&&a.data.viewer.outgoing_friend_requests_connection){let e=a.data.viewer;i=e.outgoing_friend_requests?e.outgoing_friend_requests.count:0,c=e.outgoing_friend_requests_connection.edges?e.outgoing_friend_requests_connection.edges:[],e.outgoing_friend_requests_connection.page_info&&e.outgoing_friend_requests_connection.page_info.has_next_page&&u(e.outgoing_friend_requests_connection.page_info.has_next_page.end_cursor,o,t)}t(i,c)},p=async(e=null,o,t=null)=>{let n=e?{scale:1}:{scale:2,cursor:e,count:20},s={__a:\"1\",fb_dtsg:o,fb_api_caller_class:\"RelayModern\",fb_api_req_friendly_name:\"FriendingCometFriendRequestsRootQuery\",variables:JSON.stringify(n),doc_id:\"4499164963466303\",server_timestamps:!0},r=await fetch(\"https://www.facebook.com/api/graphql/\",{method:\"POST\",headers:{\"Content-Type\":\"application/x-www-form-urlencoded\",Accept:\"text/html,application/json\",\"x-fb-friendly-name\":\"FriendingCometFriendRequestsRootQuery\"},body:function(e){let o=[];for(let t in e)e.hasOwnProperty(t)&&o.push(encodeURIComponent(t)+\"=\"+encodeURIComponent(e[t]));return o.join(\"&\")}(s)}),a=await r.json(),i=0,c=[];if(a.data&&a.data.viewer&&a.data.viewer.friending_possibilities){let e=a.data.viewer;i=e.friend_requests?e.friend_requests.count:0,c=e.friending_possibilities?e.friending_possibilities.edges:[],e.friending_possibilities.page_info&&e.friending_possibilities.page_info.has_next_page&&p(e.friending_possibilities.page_info.has_next_page.end_cursor,o,t)}t(i,c)}}});","extractedComments":[]}